<!DOCTYPE html>
<html lang="en">

<head>
  <title>
  Popcorn Machine - HackTheBox · Celero0 Blog
</title>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="color-scheme" content="light dark">




<meta name="author" content="CeleroRKX">
<meta name="description" content="Esta es una máquina de Hackthebox de nivel fácil.">
<meta name="keywords" content="blog,developer,personal">



  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Popcorn Machine - HackTheBox">
  <meta name="twitter:description" content="Esta es una máquina de Hackthebox de nivel fácil.">

<meta property="og:url" content="https://celero0.github.io/posts/popcorn/">
  <meta property="og:site_name" content="Celero0 Blog">
  <meta property="og:title" content="Popcorn Machine - HackTheBox">
  <meta property="og:description" content="Esta es una máquina de Hackthebox de nivel fácil.">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-11-24T18:35:18+00:00">
    <meta property="article:modified_time" content="2025-11-24T18:35:18+00:00">




<link rel="canonical" href="https://celero0.github.io/posts/popcorn/">


<link rel="preload" href="/fonts/fa-brands-400.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="/fonts/fa-regular-400.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="/fonts/fa-solid-900.woff2" as="font" type="font/woff2" crossorigin>


  
  
  <link rel="stylesheet" href="/css/coder.min.4b392a85107b91dbdabc528edf014a6ab1a30cd44cafcd5325c8efe796794fca.css" integrity="sha256-SzkqhRB7kdvavFKO3wFKarGjDNRMr81TJcjv55Z5T8o=" crossorigin="anonymous" media="screen" />






  
    
    
    <link rel="stylesheet" href="/css/coder-dark.min.a00e6364bacbc8266ad1cc81230774a1397198f8cfb7bcba29b7d6fcb54ce57f.css" integrity="sha256-oA5jZLrLyCZq0cyBIwd0oTlxmPjPt7y6KbfW/LVM5X8=" crossorigin="anonymous" media="screen" />
  



 




<link rel="icon" type="image/svg+xml" href="/img/favicon.svg" sizes="any">
<link rel="icon" type="image/png" href="/img/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/img/favicon-16x16.png" sizes="16x16">

<link rel="apple-touch-icon" href="/images/apple-touch-icon.png">
<link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">

<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/images/safari-pinned-tab.svg" color="#5bbad5">









</head>






<body class="preload-transitions colorscheme-auto">
  
<div class="float-container">
    <a id="dark-mode-toggle" class="colorscheme-toggle">
        <i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i>
    </a>
</div>


  <main class="wrapper">
    <nav class="navigation">
  <section class="container">
    
    <a class="navigation-title" href="https://celero0.github.io/">
      Celero0 Blog
    </a>
    
    
      <input type="checkbox" id="menu-toggle" />
      <label class="menu-button float-right" for="menu-toggle">
        <i class="fa-solid fa-bars fa-fw" aria-hidden="true"></i>
      </label>
      <ul class="navigation-list">
        
          
            <li class="navigation-item">
              <a class="navigation-link " href="/posts/">Writeups</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link " href="/about/">About</a>
            </li>
          
        
        
      </ul>
    
  </section>
</nav>


    <div class="content">
      
  <section class="container post">
    <article>
      <header>
        <div class="post-title">
          <h1 class="title">
            <a class="title-link" href="https://celero0.github.io/posts/popcorn/">
              Popcorn Machine - HackTheBox
            </a>
          </h1>
        </div>
        <div class="post-meta">
          <div class="date">
            <span class="posted-on">
              <i class="fa-solid fa-calendar" aria-hidden="true"></i>
              <time datetime="2025-11-24T18:35:18Z">
                November 24, 2025
              </time>
            </span>
            <span class="reading-time">
              <i class="fa-solid fa-clock" aria-hidden="true"></i>
              3-minute read
            </span>
          </div>
          
          
          
        </div>
      </header>

      <div class="post-content">
        
        <hr>
<ul>
<li>Tags: #Linux #Easy</li>
</ul>
<hr>
<h1 id="enumeración-nmap">
  Enumeración Nmap
  <a class="heading-link" href="#enumeraci%c3%b3n-nmap">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h1>
<p><strong>Comando:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>nmap -p- --open -sS -vvv --min-rate <span style="color:#a5d6ff">5000</span> -n -Pn 10.10.10.6 -oG allPorts
</span></span></code></pre></div><p>En el escaneo encontramos dos puertos abiertos, el puerto 22 que corre el servicio SSH, el cual por su versión 5.1p1 es vulnerable a <code>UserEnumeration</code>. Además del servicio HTTP que corre por el puerto 80, donde nos muestra el nombre de dominio <code>popcorn.htb</code>
<img src="/images/Pasted image 20251031205654.png" style="width:100%; height:auto; display:block; margin:auto;"></p>
<p>Por lo tanto, procederemos a agregar el dominio <code>popcorn.htb</code> a nuestro <code>/etc/hosts</code>
<img src="/images/Pasted image 20251031210718.png" style="width:100%; height:auto; display:block; margin:auto;"></p>
<h1 id="enumeración-http-puerto-80">
  Enumeración HTTP puerto 80
  <a class="heading-link" href="#enumeraci%c3%b3n-http-puerto-80">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h1>
<p>Entrando en el dominio <code>popcorn.htb</code> encontramos una página estatica
<img src="/images/Pasted image 20251031213420.png" style="width:100%; height:auto; display:block; margin:auto;"></p>
<p>Utilizando <code>fuzz</code> de la siguiente manera</p>
<div class="highlight"><pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ffuf -u http://popcorn.htb/FUZZ -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -t <span style="color:#a5d6ff">100</span> -fs <span style="color:#a5d6ff">177</span>
</span></span></code></pre></div><p>Encontramos los siguientes 3 directorios:
<img src="/images/Pasted image 20251031213541.png" style="width:100%; height:auto; display:block; margin:auto;"></p>
<p>En el directorio <code>test</code>, encontramos una página de <code>PHP 5.2.10</code> por defecto
<img src="/images/Pasted image 20251031213650.png" style="width:100%; height:auto; display:block; margin:auto;"></p>
<p>En el directorio <code>torrent</code> encontramos la página de #TorrentHoster
<img src="/images/Pasted image 20251031213720.png" style="width:100%; height:auto; display:block; margin:auto;"></p>
<p>Y en el directiorio <code>rename</code> nos encontramos con el siguiente mensaje
<code>Renamer API Syntax: index.php?filename=old_file_path_an_name&amp;newfilename=new_file_path_and_name</code></p>
<p>El cual parece ser un script en PHP que permite cambiar el nombre de un archivo proporcionando la ruta absoluta del archivo.
<img src="/images/Pasted image 20251031213803.png" style="width:100%; height:auto; display:block; margin:auto;"></p>
<h2 id="enumeración-de-torrenthoster">
  Enumeración de TorrentHoster
  <a class="heading-link" href="#enumeraci%c3%b3n-de-torrenthoster">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<p>En la página de TorrentHoster nos permite loguearnos o registrarnos, como no tenemos credenciales procederemos a registrarnos con <code>rkx:rkx</code>
<img src="/images/Pasted image 20251031214030.png" style="width:100%; height:auto; display:block; margin:auto;"></p>
<p>Al loguearnos con nuestra cuenta registrada, vemos el inciso de upload <code>http://popcorn.htb/torrent/torrents.php?mode=upload</code> que nos permite subir algún archivo torrent
<img src="/images/Pasted image 20251031214146.png" style="width:100%; height:auto; display:block; margin:auto;"></p>
<p>Buscamos en la web un archivo .torrent de ejemplo y lo descargamos
<img src="/images/Pasted image 20251031220034.png" style="width:100%; height:auto; display:block; margin:auto;"></p>
<h1 id="subida-archivo-maliciosa">
  Subida archivo maliciosa
  <a class="heading-link" href="#subida-archivo-maliciosa">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h1>
<p>Con el archivo de ejemplo subimos el .torrent
<img src="/images/Pasted image 20251031220134.png" style="width:100%; height:auto; display:block; margin:auto;"></p>
<p>Y Vemos que nos permite subir una imagen en nuestro archivo
<img src="/images/Pasted image 20251031220628.png" style="width:100%; height:auto; display:block; margin:auto;"></p>
<p>Pasando el click por encima de la imagen vemos la ruta <code>popcorn.htb/torrent/upload/noss.png</code>, por tanto subiremos un archivo .png con una reverseshell en php, para posteriormente con la utilidad  <code>rename</code> renombrar la extensión a .php y ser interpretado el codigo</p>
<img src="/images/Pasted image 20251031220910.png" style="width:100%; height:auto; display:block; margin:auto;">
<p>Vamos a subir el archivo <code>reverse.png</code>
<img src="/images/Pasted image 20251031220938.png" style="width:100%; height:auto; display:block; margin:auto;">
y nos muestra que se subió exitosamente
<img src="/images/Pasted image 20251031220953.png" style="width:100%; height:auto; display:block; margin:auto;"></p>
<p>El archivo al subirse se le cambio el nombre, pero podemos verlo
<img src="/images/Pasted image 20251031222335.png" style="width:100%; height:auto; display:block; margin:auto;">
su nombre es <code>d0d14c926e6e99761a2fdcff27b403d96376eff6.png</code></p>
<p>Ahora vamos a la ruta <code>popcorn.htb/rename/</code> y vemos que la API se utiliza con <code>index.php?filename=nombre del archivo viejo&amp;newfilename=nombre del archivo nuevo</code></p>
<p>Como no sabemos la ruta absoluta de donde se alberga el torrent podemos intentar adivinarla, pero no es necesario, ya que al poner cualquier valor vemos un mensaje de error mostrandonos la ruta de la aplicación siendo <code>/var/www/rename/index.php</code></p>
<p>Por lo tanto podemos hacer la estructura por detrás de la web</p>
<img src="/images/Pasted image 20251031222420.png" style="width:100%; height:auto; display:block; margin:auto;">
<p>Nuestra reverse shell se encuentra en la ruta <code>/var/www/torrent/upload/d0d14c926e6e99761a2fdcff27b403d96376eff6.png</code>, por tanto para cambiarle el nombre, y que sea interpretado el código debemos hacer lo siguiente</p>
<div class="highlight"><pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>http://popcorn.htb/rename/index.php?filename<span style="color:#ff7b72;font-weight:bold">=</span>/var/www/torrent/upload/d0d14c926e6e99761a2fdcff27b403d96376eff6.png&amp;<span style="color:#79c0ff">newfilename</span><span style="color:#ff7b72;font-weight:bold">=</span>/var/www/torrent/upload/reverse.php
</span></span></code></pre></div><p>y obtenemos un OK!, por tanto podemos suponer que el cambio de nombre resultó exitoso
<img src="/images/Pasted image 20251031222540.png" style="width:100%; height:auto; display:block; margin:auto;"></p>
<p>Ahora nos pondremos en escucha por el puerto 4443 con <code>nc</code></p>
<div class="highlight"><pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>nc -nlvp <span style="color:#a5d6ff">4443</span>
</span></span></code></pre></div><img src="/images/Pasted image 20251031222622.png" style="width:100%; height:auto; display:block; margin:auto;">
<p>Y hacemos un curl a <code>http://popcorn.htb/torrent/upload/reverse.php</code>, y obtenemos la shell
<img src="/images/Pasted image 20251031223055.png" style="width:100%; height:auto; display:block; margin:auto;"></p>
<h1 id="escalada-de-privilegios">
  Escalada de privilegios
  <a class="heading-link" href="#escalada-de-privilegios">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h1>
<p>Para escalar privilegios primero vemos la versión del kernel, con el comando <code>uname</code></p>
<div class="highlight"><pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>uname -r
</span></span></code></pre></div><p>Tenemos que la versión del kernel es <code>2.6.31-14</code>
<img src="/images/Pasted image 20251031225646.png" style="width:100%; height:auto; display:block; margin:auto;"></p>
<p>Por tanto buscamos por vulnerabilidades a esa versión y encontramos el dirtycow
<img src="/images/Pasted image 20251031225730.png" style="width:100%; height:auto; display:block; margin:auto;"></p>
<p>#Dirtycow</p>
<p>El dirty cow es una vulnerabilidad de kernel que afecta a <code>Linux Kernel 2.6.22 &lt; 3.9</code>, la vulnerabilidad edita el archivo <code>/etc/passwd</code> agregando un usuario en este caso <code>firefart</code> con privilegios root</p>
<img src="/images/Pasted image 20251031225940.png" style="width:100%; height:auto; display:block; margin:auto;">
<p>Copiamos todo el script y creamos el archivo dirtycow.c, el archivo se compila de la siguiente forma</p>
<div class="highlight"><pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>gcc -pthread dirtycow.c -o dirty -lcrypt
</span></span></code></pre></div><p>Una vez compilado tenemos el archivo <code>dirty</code>
<img src="/images/Pasted image 20251031230142.png" style="width:100%; height:auto; display:block; margin:auto;"></p>
<p>Ahora si corremos el archivo con  <code>./dirty</code>, nos pedirá escribir una contraseña. Deberemos escribir una contraseña robusta y hacemos <code>su firefart</code>
obteniendo permisos <code>root</code> y la flag <code>/root/root.txt</code>
<img src="/images/Pasted image 20251031230517.png" style="width:100%; height:auto; display:block; margin:auto;"></p>

      </div>


      <footer>
        


        
        
        
        
        
        
        
      </footer>
    </article>

    
  </section>

    </div>

    <footer class="footer">
  <section class="container">
    ©
    
      2019 -
    
    2025
     CeleroRKX 
    ·
    
    Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> & <a href="https://github.com/luizdepra/hugo-coder/" target="_blank" rel="noopener">Coder</a>.
    
  </section>
</footer>

  </main>

  

  
  
  <script src="/js/coder.min.6ae284be93d2d19dad1f02b0039508d9aab3180a12a06dcc71b0b0ef7825a317.js" integrity="sha256-auKEvpPS0Z2tHwKwA5UI2aqzGAoSoG3McbCw73gloxc="></script>
  

  

  


  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
</body>
</html>
